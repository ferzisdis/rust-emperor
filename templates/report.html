{% extends "base.html" %} {% block title %}Round Report - Year {{ state.year - 1
}}{% endblock %} {% block content %}
<div class="report-view">
    <div class="report-content">
        <h2><img src="/static/images/deg_castle5.png" alt="Report" style="height: 1.2em; vertical-align: middle;"> Round Report - Year {{ state.year - 1 }}</h2>

        <div class="report-section">
            <h3><img src="/static/images/deg_gold.png" alt="Gold" style="height: 1em; vertical-align: middle;"> Income & Production</h3>

            <div class="report-item">
                <span class="report-label">Taxes Collected:</span>
                <span class="report-value positive"
                    >+{{ state.taxes_value }} <img src="/static/images/deg_gold.png" alt="Gold" style="height: 0.9em; vertical-align: middle;"></span
                >
            </div>

            <div class="report-item">
                <span class="report-label">Market Income:</span>
                <span class="report-value positive"
                    >+{{ state.market_place_value }} <img src="/static/images/deg_gold.png" alt="Gold" style="height: 0.9em; vertical-align: middle;"></span
                >
            </div>

            <div class="report-item">
                <span class="report-label">Harvest:</span>
                <span
                    class="report-value {% if state.harvest_value > 0 %}positive{% else %}negative{% endif %}"
                >
                    {{ state.harvest_value }} <img src="/static/images/deg_food.png" alt="Food" style="height: 0.9em; vertical-align: middle;"> ({{ state.harvest_percent }}%)
                </span>
            </div>
        </div>

        <div class="report-section">
            <h3>Popularity</h3>

            <div class="report-item">
                <span class="report-label">Current Popularity:</span>
                <span class="report-value"
                    >{{ state.popularity_percent }}%</span
                >
            </div>

            <div class="report-item">
                <span class="report-label">Change:</span>
                {% set popularity_change = state.popularity_percent -
                state.previous_popularity_percent %}
                <span
                    class="report-value {% if popularity_change > 0 %}positive{% else %}{% if popularity_change < 0 %}negative{% endif %}{% endif %}"
                >
                    {% if popularity_change > 0 %}+{% endif %}{{
                    popularity_change }}%
                </span>
            </div>
        </div>

        {% match state.last_event_title %} {% when Some with (title) %}
        <div class="report-section event-section">
            <h3>Event: {{ title }}</h3>
            {% match state.last_event_description %} {% when Some with (desc) %}
            <p class="event-description">{{ desc }}</p>
            {% when None %} {% endmatch %}
        </div>
        {% when None %} {% endmatch %}

        <div class="button-group">
            <form action="/game/continue-from-report" method="post">
                <button type="submit" class="btn btn-primary">Continue</button>
            </form>
        </div>
    </div>
</div>

{% endblock %}
